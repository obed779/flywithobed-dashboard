
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>✈️ FlyWithObed Live Aviator Dashboard</title>

  <!-- ✅ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- ✅ Socket.io -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

  <style>
    body {
      background: radial-gradient(circle at center, #001f3f, #000);
      color: white;
      font-family: "Poppins", sans-serif;
      overflow: hidden;
    }
    #plane {
      transition: transform 0.2s ease;
    }
  </style>
</head>
<body class="flex flex-col h-screen">

  <!-- 🧭 Header -->
  <header class="flex justify-between items-center bg-gray-800 p-4 text-white text-lg font-bold shadow-md">
    <div>✈️ FlyWithObed Live Aviator Dashboard</div>
    <div id="balance" class="text-yellow-400">💰 Balances: Loading...</div>
  </header>

  <!-- 🧩 Main Layout -->
  <div class="flex flex-1">
    <!-- 📈 History (Left Side) -->
    <div class="w-1/4 p-3 bg-gray-900 overflow-y-auto border-r border-gray-700">
      <h2 class="text-xl font-semibold mb-2 text-yellow-300">📈 History</h2>
      <table id="history" class="w-full text-sm">
        <thead>
          <tr class="text-yellow-400 border-b border-gray-600">
            <th class="text-left py-1">Round</th>
            <th class="text-right py-1">Crash</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- 🛩️ Live Flight + Chat (Center) -->
    <div class="flex-1 flex flex-col items-center justify-center">
      <div id="status" class="text-2xl font-bold mb-2 text-green-400">Connecting...</div>
      <div id="plane" class="text-7xl mb-4">🛩️</div>
      <div id="multiplier" class="text-5xl font-mono text-yellow-400 mb-6">1.00x</div>

      <!-- 💬 Live Chat -->
      <div class="w-3/4 h-40 overflow-y-auto bg-gray-800 p-3 rounded-md border border-gray-700" id="chat"></div>
      <input
        id="chatInput"
        placeholder="Type message..."
        class="mt-2 w-3/4 p-2 rounded text-black outline-none"
      />
    </div>

    <!-- 👨‍✈️ Player Panels (Right Side) -->
    <div class="w-1/4 p-3 bg-gray-900 border-l border-gray-700">
      <div class="mb-6">
        <h2 class="text-xl font-semibold mb-2 text-blue-400">👨‍✈️ Player A</h2>
        <div id="playerA" class="text-sm text-gray-200">
          Balance: $1000<br />
          Bet: —<br />
          Cashout: —
        </div>
      </div>

      <div>
        <h2 class="text-xl font-semibold mb-2 text-pink-400">🧑‍✈️ Player B</h2>
        <div id="playerB" class="text-sm text-gray-200">
          Balance: $1000<br />
          Bet: —<br />
          Cashout: —
        </div>
      </div>
    </div>
  </div>

  <!-- 🎯 Betting Controls -->
  <footer class="bg-gray-800 p-4 flex justify-around border-t border-gray-700">
    <div class="text-center">
      <div class="mb-2 text-blue-300 font-semibold">👨‍✈️ Player A</div>
      <button id="betA" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Bet</button>
      <button id="cashoutA" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded ml-2">Cashout</button>
    </div>
    <div class="text-center">
      <div class="mb-2 text-pink-300 font-semibold">🧑‍✈️ Player B</div>
      <button id="betB" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Bet</button>
      <button id="cashoutB" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded ml-2">Cashout</button>
    </div>
  </footer>

  <!-- 📡 Socket Connection Logic -->
  <script>
    // 🟢 Connect to your backend — change this to match your Render or local URL
    const socket = io("https://flywithobed.onrender.com");

    const status = document.getElementById("status");
    const multiplierDisplay = document.getElementById("multiplier");
    const plane = document.getElementById("plane");
    const chatBox = document.getElementById("chat");
    const chatInput = document.getElementById("chatInput");
    const historyBody = document.querySelector("#history tbody");
    const balanceDisplay = document.getElementById("balance");
    const playerA = document.getElementById("playerA");
    const playerB = document.getElementById("playerB");

    let balances = { A: 1000, B: 1000 };

    // 🔌 Connection
    socket.on("connect", () => {
      status.textContent = "🛫 Connected — waiting for round...";
    });

    // 🛫 Round Start
    socket.on("roundStart", (data) => {
      status.textContent = `🛫 Round ${data.round} started — flying...`;
      multiplierDisplay.textContent = "1.00x";
      plane.textContent = "🛩️";
    });

    // 📈 Round Updates
    socket.on("roundUpdate", (data) => {
      multiplierDisplay.textContent = `${data.multiplier.toFixed(2)}x`;
      plane.style.transform = `translateX(${data.multiplier * 15}px)`;
    });

    // 💥 Round End (Crash)
    socket.on("roundEnd", (data) => {
      status.textContent = `💥 Crashed at ${data.crashPoint}x`;
      plane.textContent = "🔥";
      const row = document.createElement("tr");
      row.innerHTML = `<td>${data.round}</td><td class='text-right text-red-400'>${data.crashPoint}x</td>`;
      historyBody.prepend(row);
    });

    // 💰 Balance Update
    socket.on("balanceUpdate", (data) => {
      balances[data.player] = data.balance;
      balanceDisplay.textContent = `💰 A: $${balances.A.toFixed(2)} | B: $${balances.B.toFixed(2)}`;
    });

    // 💬 Chat Messages
    socket.on("chatMessage", (msg) => {
      const p = document.createElement("p");
      p.textContent = msg;
      chatBox.appendChild(p);
      chatBox.scrollTop = chatBox.scrollHeight;
    });

    // ✉️ Send Chat
    chatInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter" && chatInput.value.trim()) {
        socket.emit("chatMessage", chatInput.value);
        chatInput.value = "";
      }
    });

    // 🎲 Betting Buttons
    document.getElementById("betA").onclick = () => socket.emit("bet", { player: "A", amount: 20 });
    document.getElementById("cashoutA").onclick = () => socket.emit("cashout", { player: "A" });
    document.getElementById("betB").onclick = () => socket.emit("bet", { player: "B", amount: 20 });
    document.getElementById("cashoutB").onclick = () => socket.emit("cashout", { player: "B" });
  </script>

</body>
</html>
