
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FlyWithObed Live Aviator Dashboard</title>
  <style>
    body {
      margin: 0;
      background: #0b1120;
      color: #fff;
      font-family: "Poppins", sans-serif;
      text-align: center;
    }
    header {
      background: #1e293b;
      padding: 1rem;
      font-size: 1.3rem;
      font-weight: 600;
    }
    .plane {
      font-size: 3rem;
      transition: transform 0.1s linear;
    }
    .multiplier {
      font-size: 2rem;
      margin: 1rem 0;
      color: #22d3ee;
    }
    .crashed {
      color: #ef4444;
    }
    table {
      margin: 1rem auto;
      border-collapse: collapse;
      width: 80%;
    }
    th, td {
      padding: 8px 10px;
      border-bottom: 1px solid #334155;
    }
    th {
      background: #1e293b;
    }
    .footer {
      margin-top: 2rem;
      color: #64748b;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <header>✈️ FlyWithObed Live Aviator Dashboard</header>

  <div id="game">
    <div class="plane" id="plane">🛩️</div>
    <div id="multiplier" class="multiplier">1.00x</div>
    <div id="status">Waiting for next round...</div>

    <h3>📈 History</h3>
    <table>
      <thead>
        <tr>
          <th>Round</th>
          <th>Crash Point</th>
        </tr>
      </thead>
      <tbody id="history"></tbody>
    </table>
  </div>

  <div class="footer">✅ Connected to FlyWithObed Aviator API</div>

  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script>
    const socket = io("https://flywithobed-skyhigh.onrender.com");
    const plane = document.getElementById("plane");
    const multiplierDisplay = document.getElementById("multiplier");
    const status = document.getElementById("status");
    const historyTable = document.getElementById("history");

    let animationFrame;
    let position = 0;

    function movePlane() {
      position += 3;
      plane.style.transform = `translateX(${position}px)`;
      animationFrame = requestAnimationFrame(movePlane);
    }

    socket.on("connect", () => {
      status.textContent = "🟢 Connected! Waiting for next flight...";
    });

    socket.on("welcome", (data) => {
      historyTable.innerHTML = "";
      data.history.forEach((h) => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${h.round}</td><td>${h.crashPoint}x</td>`;
        historyTable.appendChild(row);
      });
    });

    socket.on("roundStart", (data) => {
      cancelAnimationFrame(animationFrame);
      position = 0;
      plane.textContent = "🛫";
      status.textContent = "🚀 Flying...";
      multiplierDisplay.textContent = "1.00x";
      plane.classList.remove("crashed");
      movePlane();
    });

    socket.on("multiplierUpdate", (data) => {
      multiplierDisplay.textContent = `${data.multiplier.toFixed(2)}x`;
    });

    socket.on("roundEnd", (data) => {
      cancelAnimationFrame(animationFrame);
      plane.textContent = "💥";
      plane.classList.add("crashed");
      status.textContent = `💥 Crashed at ${data.crashPoint}x`;
      const newRow = document.createElement("tr");
      newRow.innerHTML = `<td>${historyTable.rows.length + 1}</td><td>${data.crashPoint}x</td>`;
      historyTable.prepend(newRow);
    });

    socket.on("disconnect", () => {
      status.textContent = "🔴 Disconnected. Waiting to reconnect...";
    });
  </script>
</body>
</html>
